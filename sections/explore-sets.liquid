{% comment %}
  @name Explore Our Sets
  @desc Showcase bundle products with overlapping images - image zone on top, cream zone below
  @block bundle_card - Add bundle product card
{% endcomment %}

<div class="explore-sets full-width">
  <div class="explore-sets__wrapper">
    <div class="explore-sets__container">
      {%- comment -%} Background Image with Mask - fills the content area {%- endcomment -%}
      {% if section.settings.background_image %}
        <div class="explore-sets__background explore-sets__background--desktop">
          <svg
            class="explore-sets__mask-svg"
            width="0"
            height="0">
            <defs>
              <clipPath id="explore-sets-mask-{{ section.id }}" clipPathUnits="objectBoundingBox">
                <path d="M0.015,0.077 C0.159,0.058,0.304,0.05,0.45,0.052 C0.596,0.054,0.741,0.067,0.885,0.089 C0.972,0.102,0.969,0.146,0.976,0.233 C0.983,0.321,0.999,0.495,0.999,0.583 C0.998,0.67,0.991,0.758,0.977,0.845 C0.964,0.932,0.945,1.018,0.92,1.103 L0.086,1.062 C0.059,0.977,0.037,0.891,0.022,0.804 C0.006,0.717,-0.006,0.629,-0.013,0.541 C-0.02,0.453,-0.022,0.365,-0.019,0.277 C-0.015,0.19,-0.004,0.103,0.015,0.018" />
              </clipPath>
            </defs>
          </svg>
          <div class="explore-sets__bg-image">
            {{ section.settings.background_image | image_url: width: 2400 | image_tag: class: 'explore-sets__bg-img', loading: 'lazy' }}
          </div>
          <div class="explore-sets__bg-gradient"></div>
        </div>
      {% endif %}

      {%- comment -%} Mobile Background Image {%- endcomment -%}
      {% if section.settings.mobile_background_image %}
        <div class="explore-sets__background explore-sets__background--mobile">
          <svg
            class="explore-sets__mask-svg"
            width="0"
            height="0">
            <defs>
              <clipPath id="explore-sets-mask-mobile-{{ section.id }}" clipPathUnits="objectBoundingBox">
                <path d="M0.015,0.077 C0.159,0.058,0.304,0.05,0.45,0.052 C0.596,0.054,0.741,0.067,0.885,0.089 C0.972,0.102,0.969,0.146,0.976,0.233 C0.983,0.321,0.999,0.495,0.999,0.583 C0.998,0.67,0.991,0.758,0.977,0.845 C0.964,0.932,0.945,1.018,0.92,1.103 L0.086,1.062 C0.059,0.977,0.037,0.891,0.022,0.804 C0.006,0.717,-0.006,0.629,-0.013,0.541 C-0.02,0.453,-0.022,0.365,-0.019,0.277 C-0.015,0.19,-0.004,0.103,0.015,0.018" />
              </clipPath>
            </defs>
          </svg>
          <div class="explore-sets__bg-image">
            {{ section.settings.mobile_background_image | image_url: width: 1200 | image_tag: class: 'explore-sets__bg-img', loading: 'lazy' }}
          </div>
          <div class="explore-sets__bg-gradient"></div>
        </div>
      {% endif %}

      {%- comment -%} Content Container - 60px internal padding {%- endcomment -%}
      <div class="explore-sets__content">
        {%- comment -%} Header Section - positioned left, over image {%- endcomment -%}
        <div class="explore-sets__header">
          {% if section.settings.heading != blank %}
            <h2 class="explore-sets__heading" style="--heading-color: {{ section.settings.heading_color }};">
              {{ section.settings.heading }}
            </h2>
          {% endif %}
          {% if section.settings.description != blank %}
            <div class="explore-sets__description" style="--description-color: {{ section.settings.description_color }};">
              {{ section.settings.description }}
            </div>
          {% endif %}
        </div>

        {%- comment -%} Cards {%- endcomment -%}
        <div class="explore-sets__cards">
          {% for block in section.blocks %}
            {% if block.type == 'bundle_card' %}
              {% assign bundle_product = block.settings.product %}
              {% assign display_products = block.settings.display_products %}
              {% assign product_count = display_products.size %}
              {% if product_count == 0 and bundle_product %}
                {% assign product_count = 1 %}
              {% endif %}
              <div class="explore-sets__card" {{ block.shopify_attributes }}>
                {%- comment -%} Product Image Box - overlays the background image {%- endcomment -%}
                <a
                  href="{{ bundle_product.url }}"
                  class="explore-sets__card-image-box"
                  style="background-color: {{ block.settings.card_bg_color }};">
                  {%- comment -%} Badge {%- endcomment -%}
                  {% if block.settings.show_badge and block.settings.badge_text != blank %}
                    <div class="explore-sets__badge">
                      <span class="explore-sets__badge-text">{{ block.settings.badge_text }}</span>
                    </div>
                  {% endif %}

                  {%- comment -%} Product Images {%- endcomment -%}
                  <div class="explore-sets__product-images explore-sets__product-images--{{ product_count }}">
                    {% if display_products.size > 0 %}
                      {% for display_product in display_products %}
                        {% if display_product.featured_image %}
                          <div class="explore-sets__product-img">
                            {{ display_product.featured_image | image_url: width: 400 | image_tag: loading: 'lazy', class: 'explore-sets__product-image' }}
                          </div>
                        {% endif %}
                      {% endfor %}
                    {% elsif bundle_product and bundle_product.featured_image %}
                      <div class="explore-sets__product-img">
                        {{ bundle_product.featured_image | image_url: width: 600 | image_tag: loading: 'lazy', class: 'explore-sets__product-image' }}
                      </div>
                    {% endif %}
                  </div>
                </a>

                {%- comment -%} Card Content - sits on cream background {%- endcomment -%}
                <div class="explore-sets__card-content">
                  <div class="explore-sets__card-header">
                    <h3 class="explore-sets__card-title">
                      {% if block.settings.custom_title != blank %}
                        {{ block.settings.custom_title | newline_to_br }}
                      {% elsif bundle_product %}
                        {{ bundle_product.title }}
                      {% endif %}
                    </h3>
                    <div class="explore-sets__card-price">
                      {% if bundle_product %}
                        {% if bundle_product.compare_at_price > bundle_product.price %}
                          <span class="explore-sets__price-compare">{{ bundle_product.compare_at_price | money }}</span>
                        {% endif %}
                        <span class="explore-sets__price-current {% if bundle_product.compare_at_price > bundle_product.price %}explore-sets__price-sale{% else %}explore-sets__price-regular{% endif %}">
                          {{ bundle_product.price | money }}
                        </span>
                      {% endif %}
                    </div>
                  </div>

                  {% if block.settings.custom_description != blank %}
                    <div class="explore-sets__card-description">
                      {{ block.settings.custom_description }}
                    </div>
                  {% elsif bundle_product.metafields.custom.short_description != blank %}
                    <div class="explore-sets__card-description">
                      {{ bundle_product.metafields.custom.short_description }}
                    </div>
                  {% elsif bundle_product.description != blank %}
                    <div class="explore-sets__card-description">
                      {{ bundle_product.description | strip_html | truncate: 150 }}
                    </div>
                  {% endif %}
                </div>
              </div>
            {% endif %}
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>

{% stylesheet %}
  .explore-sets {
    background-color: #FFF7EA;
    padding: 0;
    position: relative;
    overflow: hidden;
  }

  .explore-sets__wrapper {
    max-width: 1600px;
    margin: 0 auto;
    padding: 0 40px;
  }

  /* Container holds both background and content, fills the content area */
  .explore-sets__container {
    position: relative;
    width: 100%;
  }


  /* 
   * Background Image - fills the container width (1520px content area)
   * Only covers TOP portion (670px height)
   */
  .explore-sets__background {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 670px;
    pointer-events: none;
    z-index: 1;
    overflow: hidden;
  }

  /* Hide mobile background on desktop */
  .explore-sets__background--mobile {
    display: none;
  }

  .explore-sets__mask-svg {
    position: absolute;
    width: 0;
    height: 0;
  }

  .explore-sets__bg-image {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
  }

  .explore-sets__background--desktop .explore-sets__bg-image {
    clip-path: url('#explore-sets-mask-{{ section.id }}');
  }

  .explore-sets__background--mobile .explore-sets__bg-image {
    clip-path: url('#explore-sets-mask-mobile-{{ section.id }}');
  }

  .explore-sets__bg-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center top;
    display: block;
  }

  .explore-sets__bg-gradient {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(to top, rgba(62, 32, 39, 0.2) 0%, rgba(62, 32, 39, 0) 40%);
  }

  .explore-sets__background--desktop .explore-sets__bg-gradient {
    clip-path: url('#explore-sets-mask-{{ section.id }}');
  }

  .explore-sets__background--mobile .explore-sets__bg-gradient {
    clip-path: url('#explore-sets-mask-mobile-{{ section.id }}');
  }

  /* Content Container - 60px internal padding from background edge */
  .explore-sets__content {
    position: relative;
    z-index: 2;
    padding: 96px 60px 150px;
  }

  /* Header Section - positioned left, over the image */
  .explore-sets__header {
    margin-bottom: 0;
  }

  /* Heading */
  .explore-sets__heading {
    font-family: var(--font-alyona);
    font-size: 85.62px;
    font-weight: 400;
    line-height: 1;
    color: var(--heading-color, #FFFAE6);
    margin: 0;
    max-width: 661px;
  }

  /* Description */
  .explore-sets__description {
    max-width: 466px;
    font-family: var(--font-jokker);
    font-size: 16px;
    line-height: 1.5;
    color: var(--description-color, #FFFAE6);
    margin: 4px 0 0;
  }

  .explore-sets__description p {
    margin: 0;
  }

  /* Cards Container - positioned to straddle image and cream areas */
  .explore-sets__cards {
    display: flex;
    gap: 20px;
    margin-top: 70px;
  }

  /* Individual Card */
  .explore-sets__card {
    width: 325px;
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  /* Card Image Box - overlays the background image */
  .explore-sets__card-image-box {
    position: relative;
    width: 325px;
    height: 420px;
    overflow: hidden;
    display: block;
    text-decoration: none;
  }

  /* Badge */
  .explore-sets__badge {
    position: absolute;
    left: 20px;
    top: 20px;
    background: #FFFFFF;
    padding: 8px 12px;
    z-index: 2;
  }

  .explore-sets__badge-text {
    font-family: var(--font-sweet-sans);
    font-weight: 500;
    font-size: 14px;
    line-height: 1;
    letter-spacing: -0.14px;
    text-transform: uppercase;
    color: #3E2027;
  }

  /* Product Images Container */
  .explore-sets__product-images {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  /* Single product layout */
  .explore-sets__product-images--1 {
    inset: 0;
  }

  .explore-sets__product-images--1 .explore-sets__product-img {
    width: 100%;
    height: 100%;
  }

  .explore-sets__product-images--1 .explore-sets__product-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* 3 products layout - overlapping row */
  .explore-sets__product-images--3 {
    left: 0;
    right: 0;
    bottom: 0;
    top: 94px;
    padding-left: 0;
    padding-right: 69.24px;
    justify-content: flex-start;
    border-radius: 10px;
  }

  .explore-sets__product-images--3 .explore-sets__product-img {
    width: 154.15px;
    height: 231.22px;
    margin-right: -69.24px;
    flex-shrink: 0;
  }

  .explore-sets__product-images--3 .explore-sets__product-img:last-child {
    margin-right: 0;
  }

  .explore-sets__product-images--3 .explore-sets__product-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* 6 products layout - 3x2 grid */
  .explore-sets__product-images--6 {
    left: 37.82px;
    top: 32px;
    width: 249.37px;
    height: 356px;
    flex-wrap: wrap;
    align-content: flex-start;
    gap: 0;
    padding-right: 53.12px;
    border-radius: 10px;
  }

  .explore-sets__product-images--6 .explore-sets__product-img {
    width: 118.27px;
    height: 177.4px;
    margin-right: -53.12px;
    flex-shrink: 0;
  }

  .explore-sets__product-images--6 .explore-sets__product-img:nth-child(3n) {
    margin-right: -53.12px;
  }

  .explore-sets__product-images--6 .explore-sets__product-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Card Content - sits on the cream background below image zone */
  .explore-sets__card-content {
    display: flex;
    flex-direction: column;
    gap: 24px;
  }

  .explore-sets__card-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    width: 100%;
  }

  .explore-sets__card-title {
    font-family: var(--font-sweet-sans);
    font-weight: 500;
    font-size: 19px;
    line-height: 1.2;
    letter-spacing: -0.19px;
    text-transform: uppercase;
    color: #3E2027;
    margin: 0;
  }

  .explore-sets__card-price {
    font-family: var(--font-sweet-sans);
    font-weight: 400;
    font-size: 18px;
    letter-spacing: -0.18px;
    text-transform: uppercase;
    color: #3E2027;
    display: flex;
    align-items: center;
    gap: 10px;
    text-align: right;
    white-space: nowrap;
  }

  .explore-sets__price-compare {
    text-decoration: line-through;
    text-decoration-skip-ink: none;
  }

  .explore-sets__price-sale {
    color: #E26046;
  }

  .explore-sets__price-regular {
    color: #3E2027;
  }

  /* Card Description */
  .explore-sets__card-description {
    font-family: var(--font-jokker);
    font-size: 16px;
    line-height: 1.5;
    color: #3E2027;
  }

  .explore-sets__card-description p {
    margin: 0;
  }


  /*
   ========================================
   TABLET STYLES (768px - 1024px) ========================================
*/
  @media (max-width: 1024px) {
    .explore-sets__wrapper {
      padding: 0 30px;
    }

    .explore-sets__background {
      height: 550px;
    }

    .explore-sets__content {
      padding: 60px 40px 80px;
    }

    .explore-sets__heading {
      font-size: 56px;
      max-width: 500px;
    }

    .explore-sets__description {
      max-width: 400px;
    }

    .explore-sets__cards {
      margin-top: 60px;
    }

    .explore-sets__card {
      width: 280px;
    }

    .explore-sets__card-image-box {
      width: 100%;
      height: 360px;
    }

    .explore-sets__product-images--3 {
      top: 70px;
    }

    .explore-sets__product-images--3 .explore-sets__product-img {
      width: 130px;
      height: 195px;
      margin-right: -58px;
    }

    .explore-sets__product-images--6 {
      left: 25px;
      top: 20px;
      width: 210px;
      height: 310px;
    }

    .explore-sets__product-images--6 .explore-sets__product-img {
      width: 95px;
      height: 142px;
      margin-right: -42px;
    }
  }


  /*
   ========================================
   MOBILE STYLES (below 768px) ========================================
*/
  @media (max-width: 767px) {
    .explore-sets__wrapper {
      padding: 0 20px;
    }

    .explore-sets__background--desktop {
      display: none;
    }

    .explore-sets__background--mobile {
      display: block;
      position: relative;
      height: 350px;
      width: 100%;
    }

    .explore-sets__background--mobile .explore-sets__bg-image,
    .explore-sets__background--mobile .explore-sets__bg-gradient {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
    }

    .explore-sets__content {
      padding: 0 20px 60px;
    }

    .explore-sets__header {
      position: absolute;
      top: 40px;
      left: 20px;
      right: 20px;
      z-index: 3;
    }

    .explore-sets__heading {
      font-size: 40px;
      max-width: 100%;
      margin: 0 0 12px;
    }

    .explore-sets__description {
      max-width: 100%;
      font-size: 14px;
      margin-top: 0;
    }

    .explore-sets__cards {
      flex-direction: column;
      align-items: center;
      gap: 30px;
      margin-top: 30px;
    }

    .explore-sets__card {
      width: 100%;
      max-width: 325px;
      gap: 18px;
    }

    .explore-sets__card-image-box {
      width: 100%;
      height: 320px;
    }

    .explore-sets__product-images--3 {
      top: 60px;
    }

    .explore-sets__product-images--3 .explore-sets__product-img {
      width: 110px;
      height: 165px;
      margin-right: -50px;
    }

    .explore-sets__product-images--6 {
      left: 20px;
      top: 20px;
      width: 200px;
      height: 280px;
    }

    .explore-sets__product-images--6 .explore-sets__product-img {
      width: 90px;
      height: 135px;
      margin-right: -40px;
    }

    .explore-sets__card-content {
      gap: 16px;
    }

    .explore-sets__card-header {
      flex-direction: row;
      gap: 10px;
    }

    .explore-sets__card-title {
      font-size: 16px;
    }

    .explore-sets__card-price {
      font-size: 16px;
    }

    .explore-sets__card-description {
      font-size: 14px;
    }
  }


  /*
   ========================================
   SMALL MOBILE (below 480px) ========================================
*/
  @media (max-width: 480px) {
    .explore-sets__header {
      top: 30px;
    }

    .explore-sets__heading {
      font-size: 32px;
    }

    .explore-sets__card-image-box {
      height: 280px;
    }

    .explore-sets__product-images--3 {
      top: 50px;
    }

    .explore-sets__product-images--3 .explore-sets__product-img {
      width: 90px;
      height: 135px;
      margin-right: -40px;
    }

    .explore-sets__product-images--6 {
      left: 15px;
      top: 15px;
      width: 170px;
      height: 250px;
    }

    .explore-sets__product-images--6 .explore-sets__product-img {
      width: 75px;
      height: 112px;
      margin-right: -33px;
    }
  }
{% endstylesheet %}

{% schema %}
  {
    "name": "t:general.explore_sets",
    "class": "explore-sets-section",
    "max_blocks": 2,
    "settings": [
      {
        "type": "header",
        "content": "t:sections.explore_sets.background_header"
      },
      {
        "type": "image_picker",
        "id": "background_image",
        "label": "t:labels.background_image"
      },
      {
        "type": "image_picker",
        "id": "mobile_background_image",
        "label": "Mobile Background Image",
        "info": "Optional. If provided, this image will be used on mobile devices (below 768px) instead of the desktop background image."
      },
      {
        "type": "header",
        "content": "t:sections.explore_sets.content_header"
      }, {
        "type": "text",
        "id": "heading",
        "label": "t:labels.heading",
        "default": "Explore our sets"
      }, {
        "type": "color",
        "id": "heading_color",
        "label": "t:labels.heading_color",
        "default": "#FFFAE6"
      }, {
        "type": "richtext",
        "id": "description",
        "label": "t:labels.description",
        "default": "<p>Meet six Baudie scents and them all.<br>Spray, wipe, and let your deodorant do its best work.</p>"
      }, {
        "type": "color",
        "id": "description_color",
        "label": "t:labels.description_color",
        "default": "#FFFAE6"
      }
    ],
    "blocks": [
      {
        "type": "bundle_card",
        "name": "t:blocks.bundle_card.name",
        "limit": 2,
        "settings": [
          {
            "type": "header",
            "content": "t:blocks.bundle_card.product_header"
          },
          {
            "type": "product",
            "id": "product",
            "label": "t:labels.bundle_product"
          },
          {
            "type": "product_list",
            "id": "display_products",
            "label": "t:labels.display_products",
            "info": "t:blocks.bundle_card.display_products_info",
            "limit": 6
          },
          {
            "type": "header",
            "content": "t:blocks.bundle_card.content_header"
          }, {
            "type": "textarea",
            "id": "custom_title",
            "label": "t:labels.custom_title",
            "info": "t:blocks.bundle_card.custom_title_info"
          }, {
            "type": "richtext",
            "id": "custom_description",
            "label": "t:labels.custom_description",
            "info": "t:blocks.bundle_card.custom_description_info"
          }, {
            "type": "header",
            "content": "t:blocks.bundle_card.styling_header"
          }, {
            "type": "color",
            "id": "card_bg_color",
            "label": "t:labels.card_background_color",
            "default": "#FCF0D2"
          }, {
            "type": "checkbox",
            "id": "show_badge",
            "label": "t:labels.show_badge",
            "default": false
          }, {
            "type": "text",
            "id": "badge_text",
            "label": "t:labels.badge_text",
            "default": "25% off"
          }
        ]
      }
    ],
    "presets": [
      {
        "name": "t:general.explore_sets"
      }
    ]
  }
{% endschema %}