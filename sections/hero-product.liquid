{% comment %}
  Hero section with large product imagery and interactive product carousel.
  Products display with their hero images from metafields and allow navigation between items.
{% endcomment %}

<section class="hero-product full-width" aria-label="{{ 'sections.hero_product.aria_label' | t }}">
  <div class="hero-product__inner">
    {%- comment -%} Hero Images Container {%- endcomment -%}
    <div class="hero-product__images" data-hero-images>
      {%- comment -%} Static Image Mode (Desktop Only) - main hero is static, secondary images cycle {%- endcomment -%}
      {% if section.settings.use_static_image and section.settings.static_hero_image %}
        <div class="hero-product__static-hero">
          <div class="hero-product__main-image">
            {%- assign static_hero_alt = section.settings.static_hero_image_alt | default: section.settings.static_hero_image.alt | default: section.settings.heading -%}
            {{ section.settings.static_hero_image | image_url: width: 2400 | image_tag: loading: 'eager', class: 'hero-product__image', alt: static_hero_alt }}
          </div>
          <div class="hero-product__image-gradient"></div>
        </div>

        {%- comment -%} Secondary Product Images (desktop only) - cycle with product cards {%- endcomment -%}
        {% for product in section.settings.hero_products %}
          <div class="hero-product__image-wrapper hero-product__image-wrapper--static {% if forloop.first %}is-active{% endif %}" data-product-index="{{ forloop.index0 }}">
            {% if product.featured_image %}
              <div class="hero-product__secondary-image">
                {{ product.featured_image | image_url: width: 1200 | image_tag: loading: 'lazy', class: 'hero-product__secondary-img', alt: product.featured_image.alt | default: product.title }}
              </div>
            {% endif %}
          </div>
        {% endfor %}
      {% else %}
        {%- comment -%} Dynamic Image Mode (Desktop) - cycles through product images {%- endcomment -%}
        {% for product in section.settings.hero_products %}
          <div class="hero-product__image-wrapper {% if forloop.first %}is-active{% endif %}" data-product-index="{{ forloop.index0 }}">
            {% if product.metafields.custom.hero_image %}
              {%- comment -%} Main Hero Image {%- endcomment -%}
              <div class="hero-product__main-image">
                {{ product.metafields.custom.hero_image | image_url: width: 2400 | image_tag: loading: 'eager', class: 'hero-product__image', alt: product.metafields.custom.hero_image.alt | default: product.title }}
              </div>

              {%- comment -%} Gradient Overlay {%- endcomment -%}
              <div class="hero-product__image-gradient"></div>
            {% endif %}

            {%- comment -%} Secondary Product Image (top right) {%- endcomment -%}
            {% if product.featured_image %}
              <div class="hero-product__secondary-image">
                {{ product.featured_image | image_url: width: 1200 | image_tag: loading: 'lazy', class: 'hero-product__secondary-img', alt: product.featured_image.alt | default: product.title }}
              </div>
            {% endif %}
          </div>
        {% endfor %}
      {% endif %}

      {%- comment -%} Mobile Product Images - always cycle with product cards (unchanged from original) {%- endcomment -%}
      {% for product in section.settings.hero_products %}
        <div class="hero-product__mobile-wrapper {% if forloop.first %}is-active{% endif %}" data-product-index="{{ forloop.index0 }}">
          {% if product.featured_image %}
            <div class="hero-product__mobile-image">
              {{ product.featured_image | image_url: width: 1200 | image_tag: loading: 'lazy', class: 'hero-product__mobile-img', alt: product.featured_image.alt | default: product.title }}
              <div class="hero-product__mobile-gradient"></div>
            </div>
          {% endif %}
        </div>
      {% endfor %}
    </div>

    {%- comment -%} Color Block - separate from images so it doesn't fade {%- endcomment -%}
    <div class="hero-product__color-block" data-color-block></div>

    {%- comment -%} Main Heading {%- endcomment -%}
    <div class="hero-product__heading" style="--heading-color: {{ section.settings.heading_color }}">
      <h1>{{ section.settings.heading }}</h1>
    </div>

    {%- comment -%} Mobile Content {%- endcomment -%}
    <div class="hero-product__mobile-content">
      <h2 class="hero-product__mobile-title">{{ section.settings.mobile_title }}</h2>
      <p class="hero-product__mobile-subtitle">{{ section.settings.mobile_subtitle }}</p>
      <a href="{{ section.settings.mobile_button_url }}" class="hero-product__mobile-button">
        {{ section.settings.mobile_button_text }}
      </a>
    </div>

    {%- comment -%} Navigation Controls {%- endcomment -%}
    {% if section.settings.hero_products.size > 1 %}
      <div class="hero-product__controls" role="group" aria-label="{{ 'sections.hero_product.carousel_controls' | t }}">
        <button
          type="button"
          class="hero-product__arrow hero-product__arrow--prev"
          aria-label="{{ 'general.previous' | t }}"
          aria-controls="hero-product-cards"
          data-hero-prev>
          <svg
            aria-hidden="true"
            focusable="false"
            xmlns="http://www.w3.org/2000/svg"
            width="12"
            height="24"
            viewBox="0 0 12 24"
            fill="none">
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M1.84306 12.7106L7.50006 18.3676L8.91406 16.9536L3.96406 12.0036L8.91406 7.05365L7.50006 5.63965L1.84306 11.2966C1.65559 11.4842 1.55028 11.7385 1.55028 12.0036C1.55028 12.2688 1.65559 12.5231 1.84306 12.7106Z"
              fill="white" />
          </svg>
        </button>
        <button
          type="button"
          class="hero-product__arrow hero-product__arrow--next"
          aria-label="{{ 'general.next' | t }}"
          aria-controls="hero-product-cards"
          data-hero-next>
          <svg
            aria-hidden="true"
            focusable="false"
            xmlns="http://www.w3.org/2000/svg"
            width="12"
            height="24"
            viewBox="0 0 12 24"
            fill="none">
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M10.1569 12.7106L4.49994 18.3676L3.08594 16.9536L8.03594 12.0036L3.08594 7.05365L4.49994 5.63965L10.1569 11.2966C10.3444 11.4842 10.4497 11.7385 10.4497 12.0036C10.4497 12.2688 10.3444 12.5231 10.1569 12.7106Z"
              fill="white" />
          </svg>
        </button>
      </div>
    {% endif %}

    {%- comment -%} Product Cards {%- endcomment -%}
    <div
      class="hero-product__cards"
      id="hero-product-cards"
      role="region"
      aria-roledescription="carousel"
      aria-label="{{ 'sections.hero_product.product_carousel' | t }}"
      data-hero-cards>
      {% for product in section.settings.hero_products %}
        {% assign card_bg = product.metafields.custom.card_background_color | default: '#FCD8B3' %}
        <div
          class="hero-product__card {% if forloop.first %}is-active{% endif %}"
          data-product-index="{{ forloop.index0 }}"
          data-card-color="{{ card_bg }}"
          role="group"
          aria-roledescription="slide"
          aria-label="{{ 'sections.hero_product.slide_of' | t: current: forloop.index, total: section.settings.hero_products.size }}"
          data-product-card>
          {%- comment -%} Rating {%- endcomment -%}
          {% if product.metafields.reviews.rating.value %}
            {% assign rating = product.metafields.reviews.rating.value.rating %}
            {% assign review_count = product.metafields.reviews.rating.value.count | default: 0 %}
          {% else %}
            {% assign rating = 0 %}
            {% assign review_count = 0 %}
          {% endif %}
          <div class="hero-product__rating" aria-label="{{ 'sections.hero_product.rating_label' | t: rating: rating, count: review_count }}">
            <div class="hero-product__stars" aria-hidden="true">
              {% for i in (1..5) %}
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="10"
                  height="10"
                  viewBox="0 0 10 10"
                  fill="none">
                  <path d="M4.76297 0.154621C4.78488 0.108197 4.81873 0.0691199 4.86069 0.0417987C4.90265 0.0144775 4.95106 0 5.00045 0C5.04984 0 5.09825 0.0144775 5.14021 0.0417987C5.18217 0.0691199 5.21602 0.108197 5.23793 0.154621L6.39282 2.60795C6.4689 2.76942 6.58121 2.90912 6.72011 3.01506C6.859 3.121 7.02033 3.19001 7.19025 3.21617L9.77302 3.61256C9.82196 3.61999 9.86793 3.64164 9.90575 3.67506C9.94357 3.70847 9.97171 3.75232 9.98701 3.80163C10.0023 3.85095 10.0041 3.90377 9.99229 3.95412C9.98045 4.00447 9.95541 4.05035 9.92001 4.08655L8.05217 5.99405C7.92899 6.11994 7.83683 6.27534 7.78362 6.44688C7.7304 6.61841 7.71773 6.80093 7.7467 6.97874L8.18766 9.67378C8.1963 9.72508 8.19102 9.77789 8.17241 9.82619C8.15381 9.87449 8.12263 9.91634 8.08244 9.94695C8.04225 9.97756 7.99467 9.99571 7.94512 9.99933C7.89556 10.0029 7.84604 9.99188 7.8022 9.9674L5.4934 8.69433C5.34128 8.61056 5.17202 8.56679 5.0002 8.56679C4.82837 8.56679 4.65912 8.61056 4.50699 8.69433L2.1987 9.9674C2.15487 9.99174 2.10541 10.0027 2.05594 9.99899C2.00647 9.99531 1.95898 9.97713 1.91887 9.94654C1.87877 9.91595 1.84765 9.87417 1.82906 9.82595C1.81048 9.77773 1.80517 9.72501 1.81374 9.67378L2.2542 6.97926C2.28329 6.80137 2.27069 6.61873 2.21747 6.44709C2.16425 6.27545 2.07202 6.11997 1.94872 5.99405L0.0808926 4.08707C0.0451927 4.05091 0.0198947 4.00496 0.00788036 3.95446C-0.00413394 3.90395 -0.00238147 3.85093 0.0129381 3.80142C0.0282576 3.7519 0.0565283 3.7079 0.0945297 3.67442C0.132531 3.64094 0.178735 3.61932 0.227879 3.61203L2.81015 3.21617C2.98026 3.19021 3.14181 3.12129 3.2809 3.01534C3.41998 2.90939 3.53243 2.76958 3.60857 2.60795L4.76297 0.154621Z" fill="#3E2027" />
                </svg>
              {% endfor %}
            </div>
            <span class="hero-product__rating-count">({{ review_count }})</span>
          </div>

          {%- comment -%} Name and Price {%- endcomment -%}
          <div class="hero-product__info">
            <h3 class="hero-product__name">{{ product.title }}</h3>
            <p class="hero-product__price">{{ product.price | money }}</p>
          </div>

          {%- comment -%} Description {%- endcomment -%}
          {% if product.metafields.custom.short_description %}
            <p class="hero-product__description">{{ product.metafields.custom.short_description }}</p>
          {% elsif product.description != blank %}
            <p class="hero-product__description">{{ product.description | strip_html | truncate: 120 }}</p>
          {% endif %}

          {%- comment -%} CTA Buttons {%- endcomment -%}
          <div class="hero-product__actions">
            {% form 'product'
              , product %}
              {%- assign selected_variant = product.selected_or_first_available_variant -%}
              <input
                type="hidden"
                name="id"
                value="{{ selected_variant.id }}">
              <button
                type="submit"
                name="add"
                class="hero-product__button hero-product__button--add"
                {% unless selected_variant.available %}
                  disabled
                  aria-disabled="true"
                  aria-label="{{ 'products.add_to_cart' | t }} - {{ 'products.sold_out' | t }}"
                {% endunless %}>
                <svg
                  aria-hidden="true"
                  focusable="false"
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  viewBox="0 0 16 16"
                  fill="none">
                  <path
                    d="M0.75 7.75H14.75M7.75 0.75V14.75"
                    stroke="#3E2027"
                    stroke-width="1.5"
                    stroke-linecap="round"
                    stroke-linejoin="round" />
                </svg>
                <span>{{ 'products.add_to_cart' | t }}</span>
              </button>
            {% endform %}
            <a href="{{ product.url }}" class="hero-product__button hero-product__button--buy">{{ 'products.view_product' | t }}</a>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</section>

{% stylesheet %}
  .hero-product {
    position: relative;
    width: 100%;
    background-color: #FFF7EA;
    overflow: hidden;
    margin-top: var(--total-header-height, 110px);
  }

  .hero-product__inner {
    position: relative;
    width: 100%;
    height: calc(100vh - var(--total-header-height, 110px));
    display: grid;
    grid-template-columns: 2fr 1fr;
  }

  /* Hero Images - spans left column */
  .hero-product__images {
    position: absolute;
    inset: 0;
    pointer-events: none;
    display: grid;
    grid-template-columns: 2fr 1fr;
  }

  .hero-product__image-wrapper {
    position: absolute;
    inset: 0;
    opacity: 0;
    transition: opacity 0.6s ease-in-out;
    display: grid;
    grid-template-columns: 2fr 1fr;
  }

  .hero-product__image-wrapper.is-active {
    opacity: 1;
  }

  /* Mobile wrappers - hidden on desktop, shown on mobile */
  .hero-product__mobile-wrapper {
    display: none;
  }

  /* Static hero mode - main image always visible */
  .hero-product__static-hero {
    position: absolute;
    inset: 0;
    display: grid;
    grid-template-columns: 2fr 1fr;
    z-index: 0;
  }

  /* Static mode wrappers only contain secondary images */
  .hero-product__image-wrapper--static {
    pointer-events: none;
  }

  /* Main Hero Image - left 2/3 */
  .hero-product__main-image {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 66.67%;
    height: 100%;
    overflow: hidden;
  }

  .hero-product__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center 30%;
  }

  /* Gradient Overlay */
  .hero-product__image-gradient {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 66.67%;
    height: 288px;
    background: linear-gradient(to top, rgba(62, 32, 39, 0.5) 0%, rgba(62, 32, 39, 0) 95%);
    pointer-events: none;
    z-index: 1;
  }

  /* Secondary Product Image - right 1/3 top */
  .hero-product__secondary-image {
    position: absolute;
    right: 0;
    width: 33.33%;
    height: calc(100% - 220px);
    overflow: hidden;
  }

  .hero-product__secondary-img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center center;
  }

  /* Mobile Product Image - hidden on desktop */
  .hero-product__mobile-image {
    display: none;
  }

  /* Mobile Content - hidden on desktop */
  .hero-product__mobile-content {
    display: none;
  }

  /* Color Block - separate from images, always visible, only color changes */
  .hero-product__color-block {
    position: absolute;
    bottom: 0;
    right: 0;
    width: 33.33%;
    height: 236px;
    background-color: #FCD8B3;
    transition: background-color 0.6s ease-in-out;
    z-index: 1;
  }

  /* Main Heading - positioned over left side */
  .hero-product__heading {
    position: absolute;
    left: 40px;
    bottom: 47px;
    max-width: 40rem;
    z-index: 2;
  }

  .hero-product__heading h1 {
    font-family: var(--font-alyona);
    font-size: clamp(48px, 5.76vw, 82.938px);
    font-weight: 400;
    line-height: 1;
    color: var(--heading-color);
    margin: 0;
  }

  /* Navigation Controls - positioned on right side */
  .hero-product__controls {
    position: absolute;
    right: 40px;
    top: 33px;
    display: flex;
    gap: 12px;
    z-index: 3;
  }

  .hero-product__arrow {
    width: 40px;
    height: 40px;
    border: 1.377px solid #FFFFFF;
    border-radius: 23.602px;
    background: transparent;
    color: #FFFFFF;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease;
    padding: 0;
  }

  .hero-product__arrow:hover {
    background-color: rgba(255, 255, 255, 0.1);
    transform: translateY(-1px);
  }

  .hero-product__arrow:active {
    transform: translateY(0);
  }

  .hero-product__arrow:focus-visible {
    outline: 2px solid #FFFFFF;
    outline-offset: 2px;
  }

  /* Product Cards - positioned on right side */
  .hero-product__cards {
    position: absolute;
    right: 0;
    bottom: 0;
    width: 33.33%;
    height: 100%;
    display: flex;
    align-items: flex-end;
    padding: 40px;
    z-index: 2;
  }

  .hero-product__card {
    position: absolute;
    bottom: 20px;
    right: 40px;
    width: calc(100% - 80px);
    display: flex;
    flex-direction: column;
    gap: 16px;
    padding: 16px;
    background-color: #FCD8B3;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.6s ease-in-out, background-color 0.6s ease-in-out;
  }

  .hero-product__card.is-active {
    opacity: 1;
    visibility: visible;
  }

  /* Rating */
  .hero-product__rating {
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .hero-product__stars {
    display: flex;
    gap: 4px;
  }

  .hero-product__rating-count {
    font-family: var(--font-jokker);
    font-size: 14px;
    line-height: 1.5;
    color: #3E2027;
  }

  /* Product Info */
  .hero-product__info {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
  }

  .hero-product__name,
  .hero-product__price {
    font-family: var(--font-sweet-sans);
    font-weight: 500;
    font-size: 18px;
    line-height: normal;
    letter-spacing: -0.18px;
    text-transform: uppercase;
    color: #3E2027;
    margin: 0;
  }

  /* Description */
  .hero-product__description {
    font-family: var(--font-jokker);
    font-size: 16px;
    line-height: 1.5;
    color: #3E2027;
    margin: 0;
  }

  /* Actions */
  .hero-product__actions {
    display: flex;
    gap: 10px;
    width: 100%;
  }

  .hero-product__actions form {
    flex: 1;
    margin: 0;
  }

  .hero-product__button {
    width: 100%;
    height: 40px;
    padding: 10px 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    font-family: var(--font-sweet-sans);
    font-weight: 500;
    font-size: 14px;
    line-height: normal;
    letter-spacing: -0.14px;
    text-transform: uppercase;
    text-decoration: none;
    border: none;
    cursor: pointer;
    transition: opacity 0.2s ease, transform 0.2s ease;
    white-space: nowrap;
  }

  .hero-product__button:hover {
    opacity: 0.9;
    transform: translateY(-1px);
  }

  .hero-product__button:active {
    opacity: 0.8;
    transform: translateY(0);
  }

  .hero-product__button--add {
    background-color: #FFFFFF;
    color: #3E2027;
  }

  .hero-product__button--add:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }

  .hero-product__button--buy {
    background-color: #3E2027;
    color: #FFFFFF;
    flex: 1;
  }

  .hero-product__button:focus-visible {
    outline: 2px solid #3E2027;
    outline-offset: 2px;
  }

  .hero-product__button--buy:focus-visible {
    outline-color: #FFFFFF;
  }

  /* Responsive - Smaller Desktop */
  @media (max-width: 1400px) {
    .hero-product__card {
      gap: 12px;
      padding: 12px;
    }

    .hero-product__name,
    .hero-product__price {
      font-size: 16px;
    }

    .hero-product__description {
      font-size: 14px;
    }

    .hero-product__button {
      padding: 8px 12px;
      font-size: 12px;
    }
  }

  /* Responsive - Tablet */
  @media (max-width: 1024px) {
    .hero-product__inner {
      height: calc(100vh - var(--total-header-height, 95px));
      min-height: 600px;
    }

    .hero-product__heading {
      left: 24px;
      bottom: 120px;
      max-width: 45%;
    }

    .hero-product__controls {
      right: 24px;
      top: 24px;
    }

    .hero-product__cards {
      padding: 16px;
    }

    .hero-product__card {
      bottom: 16px;
      right: 16px;
      width: calc(100% - 32px);
      gap: 10px;
      padding: 10px;
    }

    .hero-product__actions {
      flex-direction: column;
    }

    .hero-product__button {
      width: 100%;
    }
  }

  /* Switch to mobile layout at 900px instead of 768px for better card display */
  @media (max-width: 900px) {
    .hero-product__inner {
      height: calc(100vh - var(--total-header-height, 95px));
      min-height: 682px;
      grid-template-columns: 1fr;
    }

    .hero-product__images {
      grid-template-columns: 1fr;
    }

    .hero-product__image-wrapper {
      grid-template-columns: 1fr;
    }

    /* Hide desktop images on mobile */
    .hero-product__main-image,
    .hero-product__image-gradient,
    .hero-product__secondary-image {
      display: none;
    }

    /* Hide static mode elements on mobile */
    .hero-product__static-hero,
    .hero-product__image-wrapper--static {
      display: none;
    }

    /* Show mobile wrapper on mobile */
    .hero-product__mobile-wrapper {
      display: block;
      position: absolute;
      inset: 0;
      opacity: 0;
      transition: opacity 0.6s ease-in-out;
    }

    .hero-product__mobile-wrapper.is-active {
      opacity: 1;
    }

    /* Show mobile image */
    .hero-product__mobile-image {
      display: block;
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
    }

    .hero-product__mobile-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center center;
    }

    .hero-product__mobile-gradient {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 288px;
      background: linear-gradient(to top, rgba(62, 32, 39, 0.5) 0%, rgba(62, 32, 39, 0) 95%);
      pointer-events: none;
    }

    /* Hide color block on mobile */
    .hero-product__color-block {
      display: none;
    }

    /* Mobile heading */
    .hero-product__heading {
      left: 50%;
      transform: translateX(-50%);
      top: 51px;
      bottom: auto;
      max-width: 100%;
      width: 100%;
      padding: 0 12px;
    }

    .hero-product__heading h1 {
      font-size: 45px;
      text-align: center;
      font-weight: 400;
    }

    /* Show mobile content */
    .hero-product__mobile-content {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      position: absolute;
      bottom: 60px;
      left: 12px;
      right: 12px;
      transform: none;
      width: auto;
      z-index: 3;
    }

    .hero-product__mobile-title {
      font-family: var(--font-alyona);
      font-size: 30px;
      font-weight: 400;
      line-height: 1;
      color: #FFFFFF;
      text-align: center;
      margin: 0;
      width: 100%;
    }

    .hero-product__mobile-subtitle {
      font-family: var(--font-jokker);
      font-size: 14px;
      line-height: 1.2;
      color: #FFFFFF;
      text-align: center;
      margin: 0;
      width: 100%;
    }

    .hero-product__mobile-button {
      margin-top: 16px;
      background-color: #3E2027;
      color: #FFFFFF;
      font-family: var(--font-sweet-sans);
      font-weight: 500;
      font-size: 12px;
      width: 138px;
      line-height: normal;
      letter-spacing: -0.12px;
      text-transform: uppercase;
      text-decoration: none;
      padding: 10px 20px;
      height: 40px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      transition: opacity 0.2s ease, transform 0.2s ease;
    }

    .hero-product__mobile-button:hover {
      opacity: 0.9;
      transform: translateY(-1px);
    }

    .hero-product__mobile-button:active {
      opacity: 0.8;
      transform: translateY(0);
    }

    /* Hide navigation controls on mobile */
    .hero-product__controls {
      display: none;
    }

    /* Hide product cards on mobile */
    .hero-product__cards {
      display: none;
    }
  }

  /* Extra small screens (320px and below) */
  @media (max-width: 320px) {
    .hero-product__heading h1 {
      font-size: 36px;
    }

    .hero-product__mobile-content {
      bottom: 30px;
      gap: 6px;
    }

    .hero-product__mobile-title {
      font-size: 22px;
    }

    .hero-product__mobile-subtitle {
      font-size: 11px;
    }

    .hero-product__mobile-button {
      margin-top: 10px;
      width: 110px;
      height: 34px;
      font-size: 10px;
    }
  }
{% endstylesheet %}

{% javascript %}
  class HeroProductCarousel {
    constructor(container) {
      this.container = container;
      this.currentIndex = 0;
      this.cards = container.querySelectorAll('[data-product-card]');
      this.images = container.querySelectorAll('[data-hero-images] [data-product-index]');
      this.colorBlock = container.querySelector('[data-color-block]');
      this.prevBtn = container.querySelector('[data-hero-prev]');
      this.nextBtn = container.querySelector('[data-hero-next]');

      if (this.cards.length <= 1) return;

      this.init();
    }

    init() {
      this.prevBtn?.addEventListener('click', () => this.prev());
      this.nextBtn?.addEventListener('click', () => this.next());

      const controls = this.container.querySelector('.hero-product__controls');
      if (controls) {
        controls.addEventListener('keydown', (e) => {
          if (e.key === 'ArrowLeft') {
            e.preventDefault();
            this.prev();
          }
          if (e.key === 'ArrowRight') {
            e.preventDefault();
            this.next();
          }
        });
      }
    }

    goTo(index) {
      const newCard = this.cards[index];
      const bgColor = newCard?.getAttribute('data-card-color') || '#FCD8B3';

      if (this.colorBlock) {
        this.colorBlock.style.backgroundColor = bgColor;
      }

      this.cards.forEach(card => {
        card.style.backgroundColor = bgColor;
      });

      this.cards.forEach(card => card.classList.remove('is-active'));
      this.images.forEach(img => img.classList.remove('is-active'));

      this.cards[index]?.classList.add('is-active');
      this.images.forEach(img => {
        if (img.getAttribute('data-product-index') === String(index)) {
          img.classList.add('is-active');
        }
      });

      this.currentIndex = index;
    }

    next() {
      const nextIndex = (this.currentIndex + 1) % this.cards.length;
      this.goTo(nextIndex);
    }

    prev() {
      const prevIndex = (this.currentIndex - 1 + this.cards.length) % this.cards.length;
      this.goTo(prevIndex);
    }
  }

  function init() {
    const heroSection = document.querySelector('.hero-product');
    if (heroSection) {
      new HeroProductCarousel(heroSection);
    }
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
{% endjavascript %}

{% schema %}
  {
    "name": "t:sections.hero_product.name",
    "class": "hero-product-section",
    "settings": [
      {
        "type": "header",
        "content": "t:sections.hero_product.settings.desktop_header"
      },
      {
        "type": "text",
        "id": "heading",
        "label": "t:labels.heading",
        "default": "Smelling good shouldn't be a gamble."
      },
      {
        "type": "color",
        "id": "heading_color",
        "label": "t:labels.heading_color",
        "default": "#FFFFFF"
      },
      {
        "type": "product_list",
        "id": "hero_products",
        "label": "t:sections.hero_product.settings.products"
      },
      {
        "type": "header",
        "content": "t:sections.hero_product.settings.image_mode_header"
      },
      {
        "type": "checkbox",
        "id": "use_static_image",
        "label": "t:sections.hero_product.settings.use_static_image",
        "info": "t:sections.hero_product.settings.use_static_image_info",
        "default": false
      },
      {
        "type": "image_picker",
        "id": "static_hero_image",
        "label": "t:sections.hero_product.settings.static_hero_image",
        "info": "t:sections.hero_product.settings.static_hero_image_info"
      },
      {
        "type": "text",
        "id": "static_hero_image_alt",
        "label": "t:sections.hero_product.settings.static_hero_image_alt",
        "info": "t:sections.hero_product.settings.static_hero_image_alt_info"
      },
      {
        "type": "header",
        "content": "t:sections.hero_product.settings.mobile_header"
      },
      {
        "type": "text",
        "id": "mobile_title",
        "label": "t:sections.hero_product.settings.mobile_title",
        "default": "Deodorant enhancer."
      },
      {
        "type": "textarea",
        "id": "mobile_subtitle",
        "label": "t:sections.hero_product.settings.mobile_subtitle",
        "default": "Not a deodorant â€” the step that makes it work better."
      },
      {
        "type": "text",
        "id": "mobile_button_text",
        "label": "t:sections.hero_product.settings.mobile_button_text",
        "default": "BUY NOW"
      },
      {
        "type": "url",
        "id": "mobile_button_url",
        "label": "t:sections.hero_product.settings.mobile_button_url"
      }
    ],
    "presets": [
      {
        "name": "t:sections.hero_product.name"
      }
    ]
  }
{% endschema %}